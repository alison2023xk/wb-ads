# 本地测试说明

## 方法1: 运行测试脚本（推荐）

直接运行测试脚本，无需启动 Streamlit：

```bash
python3 test_save_config.py
```

这个脚本会：
- ✅ 测试配置生成功能
- ✅ 测试保存逻辑
- ✅ 显示生成的配置内容
- ✅ 验证 YAML 格式

## 方法2: 运行 Streamlit 应用

启动 Streamlit 应用进行交互式测试：

```bash
streamlit run streamlit_app.py
```

然后在浏览器中：
1. 选择广告活动
2. 添加规则
3. **勾选"🔍 显示保存调试信息"复选框**（在保存按钮上方）
4. 点击"保存到服务器"按钮
5. 查看展开的调试信息面板

## 调试信息包含

当勾选"显示保存调试信息"后，会显示：

- **Session State 状态**
  - selected_ids
  - rules 数量
  - yaml_data 是否存在
  - 规则详情

- **配置生成过程**
  - 从 session_state 获取的数据
  - 配置生成结果

- **API 请求详情**
  - 请求 URL
  - 请求 Headers
  - 数据长度
  - 响应状态码
  - 响应内容
  - 详细错误信息（如果有）

## 常见问题

### 问题：没有出现调试信息面板

**解决方案：**
1. 确保勾选了"🔍 显示保存调试信息"复选框
2. 调试信息会在点击保存按钮后，在错误/成功消息下方显示
3. 如果还是没有，检查浏览器控制台是否有 JavaScript 错误

### 问题：提示"当前没有生成配置"

**可能原因：**
1. 没有选择广告活动
2. 没有添加规则
3. 规则中没有配置时间段

**解决方案：**
运行测试脚本查看详细状态：
```bash
python3 test_save_config.py
```

## 测试结果

运行 `test_save_config.py` 应该看到：

```
✅ 配置生成测试: ✅ 通过
✅ 保存逻辑测试: ✅ 通过
✅ API 保存测试: ✅ 通过

🎉 所有测试通过!
```

如果测试失败，会显示详细的错误信息。

